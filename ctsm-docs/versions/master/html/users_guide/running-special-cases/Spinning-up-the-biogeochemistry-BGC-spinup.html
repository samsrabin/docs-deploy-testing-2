

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1.5.7. Spinup of CTSM1-BGC-Crop &mdash; ctsm CTSM master documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=a16e412b" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=c0caff61"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.5.8. Running with excess ground ice" href="Running-with-excess-ground-ice.html" />
    <link rel="prev" title="1.5.6. Spinning up the Satellite Phenology Model" href="Spinning-up-the-Satellite-Phenology-Model-CLMSP-spinup.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            ctsm
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">1. CTSM1 User’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview/index.html">1.1. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setting-up-and-running-a-case/index.html">1.2. Setting Up and Running a Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using-clm-tools/index.html">1.3. Using CLM tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adding-new-resolutions/index.html">1.4. Adding New Resolutions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">1.5. Running Special Cases</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="What-is-a-special-case.html">1.5.1. What is a special case?</a></li>
<li class="toctree-l3"><a class="reference internal" href="Running-the-prognostic-crop-model.html">1.5.2. Running the prognostic crop model</a></li>
<li class="toctree-l3"><a class="reference internal" href="Running-with-irrigation.html">1.5.3. Running with irrigation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Running-with-custom-crop-calendars.html">1.5.4. Running with custom crop calendars</a></li>
<li class="toctree-l3"><a class="reference internal" href="Running-with-tillage.html">1.5.5. Running with tillage</a></li>
<li class="toctree-l3"><a class="reference internal" href="Spinning-up-the-Satellite-Phenology-Model-CLMSP-spinup.html">1.5.6. Spinning up the Satellite Phenology Model</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">1.5.7. Spinup of CTSM1-BGC-Crop</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-ad-spinup-simulation-for-version-bgc">1.5.7.1. Example: AD_SPINUP Simulation for CTSM1-BGC</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-final-clmbgc-spinup-simulation-for-version-bgc">1.5.7.2. Example: Final CLMBGC Spinup Simulation for CTSM1-BGC</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Running-with-excess-ground-ice.html">1.5.8. Running with excess ground ice</a></li>
<li class="toctree-l3"><a class="reference internal" href="Running-with-MOAR-data-as-atmospheric-forcing-to-spinup-the-model.html">1.5.9. Running with MOAR data</a></li>
<li class="toctree-l3"><a class="reference internal" href="Running-with-your-own-previous-simulation-as-atmospheric-forcing-to-spinup-the-model.html">1.5.10. Running with atmospheric forcing from a previous simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Running-with-anomaly-forcing.html">1.5.11. Running with anomaly forcing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../running-single-points/index.html">1.6. Running Single Point and Regional Cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trouble-shooting/index.html">1.7. Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/index.html">1.8. Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using-mesh-maker/index.html">1.9. Using mesh_maker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working-with-documentation/index.html">1.10. Working with CTSM Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tech_note/index.html">2. CLM Technical Note</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lilac/index.html">3. CTSM-LILAC User’s Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ctsm</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html"><span class="section-number">1. </span>CTSM1 User’s Guide</a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">1.5. </span>Running Special Cases</a></li>
      <li class="breadcrumb-item active"><span class="section-number">1.5.7. </span>Spinup of CTSM1-BGC-Crop</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/users_guide/running-special-cases/Spinning-up-the-biogeochemistry-BGC-spinup.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="spinup-of-version-bgc-crop">
<span id="spinning-up-clm-bgc"></span><h1><span class="section-number">1.5.7. </span>Spinup of CTSM1-BGC-Crop<a class="headerlink" href="#spinup-of-version-bgc-crop" title="Link to this heading"></a></h1>
<p>To get the CTSM1-BGC model to a steady state, you first run it from arbitrary initial conditions using the “accelerated decomposition spinup” (<code class="docutils literal notranslate"><span class="pre">-bgc_spinup</span> <span class="pre">on</span></code> in CLM <code class="docutils literal notranslate"><span class="pre">configure</span></code>, see example below) mode for about 200 simulation years. <a class="reference internal" href="#figure-bgc-ad-spinup-plot-for-1850-gswp3"><span class="std std-numref">Figure 1.5.3</span></a> shows spinup behavior for an 1850 BGC accelerated decomposition (AD) case using GSWP3 atmospheric forcing. Generally, the criteria that less than 3% of the land surface be in total ecosystem carbon disequilibrium takes the longest to satisfy due to slow soil carbon (TOTSOMC) turnover times in the Arctic.</p>
<figure class="align-default" id="id1">
<span id="figure-bgc-ad-spinup-plot-for-1850-gswp3"></span><img alt="../../_images/image32.png" src="../../_images/image32.png" />
<figcaption>
<p><span class="caption-number">Figure 1.5.3 </span><span class="caption-text">BGC AD spinup plot for a year 1850 case with GSWP3 atmospheric forcing. Variables examined are TOTECOSYSC (total ecosystem carbon), TOTSOMC (total soil organic matter carbon), TOTVEGC (total vegetation carbon), TLAI (total leaf area index), GPP (gross primary production) and TWS (total water storage). Generated using …/tools/contrib/SpinupStability.ncl.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>After this you branch from this mode in the “final spinup” (<code class="docutils literal notranslate"><span class="pre">-bgc_spinup</span> <span class="pre">off</span></code> in CLM <code class="docutils literal notranslate"><span class="pre">configure</span></code>, see example below), and run for several hundred simulation years. <a class="reference internal" href="#figure-bgc-pad-spinup-plot-for-1850-gswp3"><span class="std std-numref">Figure 1.5.4</span></a> shows spinup behavior for an 1850 BGC post accelerated decomposition (pAD) case using GSWP3 atmospheric forcing. As before, the criteria that less than 3% of the land surface be in total ecosystem carbon disequilibrium takes the longest to satisfy. It can be difficult to meet this strict criteria in less than 1000 years and users may want to relax this criteria depending on their application.</p>
<figure class="align-default" id="id2">
<span id="figure-bgc-pad-spinup-plot-for-1850-gswp3"></span><img alt="../../_images/image4.png" src="../../_images/image4.png" />
<figcaption>
<p><span class="caption-number">Figure 1.5.4 </span><span class="caption-text">BGC pAD spinup plot for a year 1850 case with GSWP3 atmospheric forcing and initialization from the end of the BGC AD spinup case. Variables examined are TOTECOSYSC (total ecosystem carbon), TOTSOMC (total soil organic matter carbon), TOTVEGC (total vegetation carbon), TLAI (total leaf area index), GPP (gross primary production) and TWS (total water storage). Generated using …/tools/contrib/SpinupStability.ncl.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>You can also start from a default initial file that is setup as part of the selected compset. <a class="reference internal" href="#figure-bgc-initialized-spinup-plot-for-1850"><span class="std std-numref">Figure 1.5.5</span></a> shows spinup behavior for an 1850 pAD BGC case that loops over one year of coupler history output for atmospheric forcing (generated from the fully coupled model), initialized with a BGC initial file generated from a GSWP3 atmospheric forcing case. Note that it takes about 10 years for variables such as TLAI (total leaf area index), GPP (gross primary production), and TWS (total water storage) to reach a specified equilibrium state (denoted by the dotted lines) due to the different atmospheric forcing.</p>
<figure class="align-default" id="id3">
<span id="figure-bgc-initialized-spinup-plot-for-1850"></span><img alt="../../_images/image5.png" src="../../_images/image5.png" />
<figcaption>
<p><span class="caption-number">Figure 1.5.5 </span><span class="caption-text">BGC initialized spinup plot for year 1850. Variables examined are TOTECOSYSC (total ecosystem carbon), TOTSOMC (total soil organic matter carbon), TOTVEGC (total vegetation carbon), TLAI (total leaf area index), GPP (gross primary production) and TWS (total water storage). Generated using …/tools/contrib/SpinupStability.ncl.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#figure-bgc-initialized-spinup-plot-for-2000-co2"><span class="std std-numref">Figure 1.5.6</span></a> shows spinup behavior for the same case but also changes CO2 to present-day conditions (379ppmv). Again, it takes about 10 years to reach equilibrium for TLAI, GPP, and TWS.</p>
<figure class="align-default" id="id4">
<span id="figure-bgc-initialized-spinup-plot-for-2000-co2"></span><img alt="../../_images/image6.png" src="../../_images/image6.png" />
<figcaption>
<p><span class="caption-number">Figure 1.5.6 </span><span class="caption-text">BGC initialized spinup plot for year 2000 CO2.  Variables examined are TOTECOSYSC (total ecosystem carbon), TOTSOMC (total soil organic matter carbon), TOTVEGC (total vegetation carbon), TLAI (total leaf area index), GPP (gross primary production) and TWS (total water storage). Generated using …/tools/contrib/SpinupStability.ncl.</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>If you use the default initial file and you signficantly change model behavior or atmospheric forcing, and you are concerned about the carbon equilibrium (e.g., TOTECOSYSC, TOTSOMC, TOTVEGC), particularly at high latitudes, then we recommend you put the model back into AD mode to reach a new equilibrium. In this configuration, this will also automatically reseed “dead” plant functional types in the initial file with a bit of leaf carbon to give those plant functional types another chance to grow under the new atmospheric forcing or model conditions.</p>
<dl class="simple">
<dt><strong>1. |version| accelerated-decomposition (AD) spinup</strong></dt><dd><p>For the first step of running 200+ years in <code class="docutils literal notranslate"><span class="pre">-bgc_spinup</span> <span class="pre">on</span></code> mode, you will setup a case, and then edit the values in env_build.xml and env_run.xml so that the right configuration is turned on and the simulation is setup to run for the required length of simulation time. So do the following:</p>
</dd>
</dl>
<section id="example-ad-spinup-simulation-for-version-bgc">
<h2><span class="section-number">1.5.7.1. </span>Example: AD_SPINUP Simulation for CTSM1-BGC<a class="headerlink" href="#example-ad-spinup-simulation-for-version-bgc" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">cd</span> <span class="n">cime</span><span class="o">/</span><span class="n">scripts</span>
<span class="o">&gt;</span> <span class="o">./</span><span class="n">create_newcase</span> <span class="o">-</span><span class="n">case</span> <span class="n">BGC_spinup</span> <span class="o">-</span><span class="n">res</span> <span class="n">f19_g17_gl4</span> <span class="o">-</span><span class="n">compset</span> <span class="n">I1850Clm50BgcCropCru</span>
<span class="o">&gt;</span> <span class="n">cd</span> <span class="n">BGC_spinup</span>
<span class="c1"># Change accelerated spinup mode</span>
<span class="o">&gt;</span> <span class="o">./</span><span class="n">xmlchange</span> <span class="n">CLM_ACCELERATED_SPINUP</span><span class="o">=</span><span class="s2">&quot;on&quot;</span>
<span class="c1"># Now setup</span>
<span class="o">&gt;</span> <span class="o">./</span><span class="n">case</span><span class="o">.</span><span class="n">setup</span> <span class="o">-</span><span class="n">case</span>
<span class="c1"># Now build</span>
<span class="o">&gt;</span> <span class="o">./</span><span class="n">case</span><span class="o">.</span><span class="n">build</span>
<span class="c1"># The following sets RESUBMIT to 3 times in env_run.xml (you could also use an editor)</span>
<span class="c1"># The following sets STOP_DATE,STOP_N and STOP_OPTION to Jan/1/0201, 20, &quot;nyears&quot; in env_run.xml (you could also use an editor)</span>
<span class="o">&gt;</span> <span class="o">./</span><span class="n">xmlchange</span> <span class="n">RESUBMIT</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">STOP_N</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">STOP_OPTION</span><span class="o">=</span><span class="n">nyears</span><span class="p">,</span><span class="n">STOP_DATE</span><span class="o">=</span><span class="mi">02010101</span>
<span class="c1"># Now run normally</span>
<span class="o">&gt;</span> <span class="o">./</span><span class="n">case</span><span class="o">.</span><span class="n">submit</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This same procedure works for CTSM1-CN as well.</p>
</div>
<p>Afterwards save the last restart file from this simulation to use in the next step.</p>
<dl class="simple">
<dt><strong>2. Final spinup for |version|-BGC</strong></dt><dd><p>Next save the last restart file from this step and use it as the <code class="docutils literal notranslate"><span class="pre">finidat</span></code> file to use for one more spinup for at least 400+ years in normal mode. So do the following:</p>
</dd>
</dl>
</section>
<section id="example-final-clmbgc-spinup-simulation-for-version-bgc">
<span id="eg-final-clmbgc-spinup"></span><h2><span class="section-number">1.5.7.2. </span>Example: Final CLMBGC Spinup Simulation for CTSM1-BGC<a class="headerlink" href="#example-final-clmbgc-spinup-simulation-for-version-bgc" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; cd cime/scripts
&gt; ./create_newcase -case BGC_finalspinup -res f19_g17_gl4 -compset I1850Clm50BgcCropCru
&gt; cd BGC_finalspinup
# Now, Copy the last CLM restart file from the earlier case into your run directory
&gt; cp /ptmp/$LOGIN/archive/BGC_spinup/rest/BGC_spinup.clm*.r*.0201-01-01-00000.nc \
/glade/scratch/$LOGIN/CN_finalspinup/run
# Set the runtype to startup
&gt; ./xmlchange RUN_TYPE=startup
# And copy the rpointer files for datm and drv from the earlier case
&gt; cp /glade/scratch/$LOGIN/archive/BGC_spinup/rest/rpointer.atm /glade/scratch/$LOGIN/CN_finalspinup/run
# Set the finidat file to the last restart file saved in previous step
&gt; echo &#39; finidat = &quot;BGC_spinup.clm2.r.0201-01-01-00000.nc&quot;&#39; &gt; user_nl_clm
# Now setup
&gt; ./case.setup
&gt; Now build
&gt; ./case.build
# The following sets RESUBMIT to 7 times in env_run.xml (you could also use an editor)
# The following sets STOP_N and STOP_OPTION to 50 and &quot;nyears&quot; in env_run.xml (you could also use an editor)
&gt; ./xmlchange RESUBMIT=7,STOP_OPTION=nyears,STOP_N=50
&gt; Now run as normal
&gt; ./case.submit
</pre></div>
</div>
<p>To assess if the model is spunup, plot trends for CLMBGC variables of interest using …/tools/contrib/SpinupStability.ncl. If you don’t meet the equilibrium criteria, you may need to run the simulation longer. Finally save the restart file from the end of this simulation to use as an “finidat” file for future simulations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This same final spinup procedure works for CTSM1-CN as well.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Spinning-up-the-Satellite-Phenology-Model-CLMSP-spinup.html" class="btn btn-neutral float-left" title="1.5.6. Spinning up the Satellite Phenology Model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Running-with-excess-ground-ice.html" class="btn btn-neutral float-right" title="1.5.8. Running with excess ground ice" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, UCAR.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
     
<script>var version_json_loc = "../../../../versions.json";</script>


</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    Version: master
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    
    
    <dl>
      <dt>Versions</dt>
      
        <dd><a href="../../../../versions/master/html/index.html">master</a></dd>
      
        <dd><a href="../../../../versions/release-clm5.0/html/index.html">release-clm5.0</a></dd>
      
    </dl>
    
    <br>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>